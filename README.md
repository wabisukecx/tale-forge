# Tale Forge(ゲームブック・エディタ)

Tale Forgeは、インタラクティブなゲームブックシナリオを作成・編集・プレビューできるWebアプリケーションです。Streamlitを使用して構築されており、直感的なUIで物語の分岐を管理できます。

## 機能

- シーンの作成と編集（動的な行追加に対応）
- 選択肢による分岐の設定（シーンあたり最大3つの選択肢）
- シーンごとの画像管理（PNG, JPG, JPEG, SVG対応）
- シーン関係図の自動生成（左から右へのフロー表示）
- インタラクティブなシナリオプレビュー機能
- TOMLファイルによるインポート/エクスポート/データ保存：scenario.toml

## 必要要件

- Python 3.8以上
- 以下のPythonパッケージ:
  - streamlit
  - pandas
  - graphviz
  - toml

## インストール

1. リポジトリをクローン:

```bash
git clone https://github.com/wabisukecx/tale-forge.git
cd tale-forge
```

2. 必要なパッケージをインストール:

```bash
pip install -r requirements.txt
```

3. アプリケーションを起動:

```bash
streamlit run app.py
```

## 使用方法

### シーン編集

1. 「シーン編集」タブでシーンを追加・編集
   - データエディターで直接編集可能
   - 動的に行を追加/削除可能
2. 各シーンには以下の要素を設定:
   - シーンID (一意の識別子)
   - ストーリーテキスト
   - 最大3つの選択肢と遷移先
3. 編集内容は自動的にscenario.tomlに保存

### 画像管理

1. シーン編集タブの下部で画像をアップロード可能
2. 対応フォーマット: PNG, JPG, JPEG, SVG
3. 各シーンに1つの画像を関連付け可能
4. SVG画像は自動的にアスペクト比を維持してリサイズ
5. アップロードした画像は自動的にscenario.tomlに保存
6. 登録済み画像の一覧表示と削除機能

### シーン関係図

- 「シーン関係図」タブで物語の構造を視覚的に確認可能
- 左から右へのフロー形式で表示
- シーンIDと簡略化されたストーリープレビューを表示
- 選択肢のテキストを矢印のラベルとして表示

### シナリオプレビュー

- 「シナリオプレビュー」タブで実際のゲーム体験をテスト可能
- レスポンシブなレイアウト（画像の有無に応じて自動調整）
- 選択肢ボタンでシーン間を移動
- 画像とテキストを適切なレイアウトで表示

## データ形式

シナリオデータは以下のようなTOML形式で保存:

```toml
[シーンID]
story = "シーンのストーリーテキスト"
choices = ["選択肢1", "選択肢2", "選択肢3"]
destinations = ["遷移先1", "遷移先2", "遷移先3"]
image = "images/シーンID.拡張子"  # 画像がある場合のみ
```

## ディレクトリ構造

```bash
tale-forge/
├── app.py             # メインアプリケーション
├── editor.py          # シーン編集機能
├── graph.py           # シーン関係図機能
├── preview.py         # シナリオプレビュー機能
├── toml_export.py     # TOMLインポート/エクスポート機能
├── requirements.txt   # 依存パッケージリスト
├── scenario.toml      # 現在のシナリオデータ
└── images/            # アップロードされた画像の保存先
```

## エラー処理

- 各機能でエラーハンドリングを実装
- エラー発生時は適切なエラーメッセージを表示
- ログ機能によるデバッグ情報の記録

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。
